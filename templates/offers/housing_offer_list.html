{% extends 'base.html' %}

{% block content %}

<!-- ========================= SECTION MAIN ========================= -->
<section class="section-content">
<!--==============selecting country and city=================-->
<div class="row col-12 mb-2">
    <div class="float-start">
        <div class="card border-success">
            <div class="card-body">

<div class="row">
  <div class="col">
            <form method="get" name="country_sel" action="">
                <input name="country_select" type="search" class="form-control border-success" list="CountrydatalistOptions" id="CountryDataList" placeholder="{{ placeholder_country }}" onchange='if(this.value != 0) { this.form.submit(); }'>
                <datalist id="CountrydatalistOptions">
                    {% for country in countries %}
                      <option value="{{ country.country }}">
                    {% endfor %}
                </datalist>
            </form>
  </div>
  <div class="col">
    <form method="get" name="city_sel" action="">
                <input name="city_select" type="search" class="form-control border-success" list="CitydatalistOptions1" id="CityDataList" placeholder="{{ placeholder_city }}" onchange='if(this.value != 0) { this.form.submit(); }'>
                <datalist id="CitydatalistOptions1">
                    {% for city in city_qs %}
                      <option value="{{ city.city }}">
                    {% endfor %}
                </datalist>
            </form>
  </div>
</div>
            </div>
        </div>
    </div>
</div>
<!--==============END selecting country and city=================-->
        <!--==============FILTERS=================-->
<div class="row col-12">
    <div class="float-start">
        <div class="card col-3" style="float: right;">
            <div class="card-title mb-0">
               <div class="card-header bg-success text-white">Filters | Фильтры</div>
            </div>
            <div class="card-body">

    <form method="get" name="filters_form" action="">
       <div class="row">
          <div class="col">

<!--sex-->
              <select name="sex" class="form-select mb-2" aria-label="sex">
                  <option value="" disabled selected>Ваш пол</option>
                  <option value=1>Женский | Female</option>
                  <option value=2>Мужской | Male</option>
                  <option value=3>Мужчины и женщины | Men & women</option>
              </select>
<!--sex//-->
<!--genderliving-->
         <select name="gender_of_living" class="form-select" aria-label="gender_of_living">
              <option value="" disabled selected>Вам подойдет жить с...</option>
              <option value=1>Женщинами | Female</option>
              <option value=2>Мужчинами | Male</option>
              <option value=3>Смешанно | Mixed</option>
              <option value=4>Ни с кем | Without anyone</option>
          </select>
<!--genderliving//-->
<hr>
<!--with_kids-->
               <label class="form-check-label" for="">С детьми | With kids</label>
         <div class="form-check">
              <input name="with_kids" class="form-check-input" type="radio" id="with_kids" value='True'>
              <label class="form-check-label" for="with_kids">да | yes</label>
         </div>
          <div class="form-check">
             <input name="with_kids" class="form-check-input" type="radio" id="with_kids" value='False'>
              <label class="form-check-label" for="with_kids">нет | no</label>
          </div>
<!--with_kids//-->
   <hr>
<!--District-->
           <label for="district" class="form-label">Район | District</label>
               <input name="district" class="form-control" type="text" maxlength="50" placeholder="Введите название | Input district name" id="district" aria-label=" input district">
<!--District//-->
   <hr>
<!--house_type-->
       <label class="form-check-label" for="">Тип жилья | Housing type</label>
         <div class="form-check">
              <input name="house_type_1" class="form-check-input" type="checkbox" id="typeCheckbox1" value='1'>
              <label class="form-check-label" for="typeCheckbox1">Квартира</label>
            </div>
            <div class="form-check">
              <input name="house_type_2"  class="form-check-input" type="checkbox" id="typeCheckbox2" value='2'>
              <label class="form-check-label" for="typeCheckbox2">Дом</label>
        </div>
           <div class="form-check ">
              <input name="house_type_3"  class="form-check-input" type="checkbox" id="typeCheckbox2" value='3'>
              <label class="form-check-label" for="typeCheckbox2">Комната</label>
            </div>
<!--house_type//-->
               <hr>
<!--rooms-->
       <label class="form-check-label" for="">Количество комнат</label>
         <div class="form-check">
              <input name="n_rooms_5" class="form-check-input" type="checkbox" id="roomsCheckbox5" value='5'>
              <label class="form-check-label" for="roomsCheckbox5">Студия | Studio</label>
            </div>
         <div class="form-check">
              <input name="n_rooms_1" class="form-check-input" type="checkbox" id="roomsCheckbox1" value='1'>
              <label class="form-check-label" for="roomsCheckbox1">1</label>
            </div>
            <div class="form-check">
              <input name="n_rooms_2"  class="form-check-input" type="checkbox" id="roomsCheckbox2" value='2'>
              <label class="form-check-label" for="roomsCheckbox2">2</label>
        </div>
           <div class="form-check ">
              <input name="n_rooms_3"  class="form-check-input" type="checkbox" id="roomsCheckbox3" value='3'>
              <label class="form-check-label" for="roomsCheckbox3">3</label>
            </div>
           <div class="form-check ">
              <input name="n_rooms_4"  class="form-check-input" type="checkbox" id="roomsCheckbox4" value='4'>
              <label class="form-check-label" for="roomsCheckbox4">4+</label>
            </div>
<!--rooms//-->
               <hr>
 <!--interior-->
               <select name="interior_condition" class="form-select mb-2" aria-label="interior_condition">
                  <option value="" disabled selected>Состояние отделки | interior condition</option>
                  <option value='1'>Новый ремонт | Good interior condition</option>
                  <option value='2'>Без ремонта | Old interior</option>
                   <option value='3'>Требуется ремонт | Repair required</option>
               </select>
<!--interior//-->
 <!--furniture-->
         <select name="furniture" class="form-select mb-2" aria-label="furniture">
              <option value="" disabled selected>Мебель | Furniture</option>
              <option value=1>Мебель полностью | Fully furnished</option>
              <option value=2>Мебель частично | Partially furnished</option>
              <option value=3>Без мебели | Without furniture</option>
         </select>
<!--furniture//-->
<!--appliances-->
         <select name="appliances" class="form-select mb-2" aria-label="appliances">
              <option value="" disabled selected>Бытовая техника | Appliances</option>
              <option value=1>Все необходимое | Necessary</option>
              <option value=2>Частично | Partially available</option>
              <option value=3>Отсутствует | No appliances</option>
              <option value=4>Необходимое и дополнительно | Necessary+</option>
         </select>
<!--appliances//-->
<!--heating-->
         <select name="heating" class="form-select" aria-label="heating">
              <option value="" disabled selected>Отопление | Heating</option>
              <option value=1>Центральное | Central heating</option>
              <option value=2>Электрическое | Electric heating</option>
              <option value=3>Газовое | Gas</option>
              <option value=4>Кондиционер | Conditioner</option>
              <option value=5>Печное | Stove heating</option>
              <option value=6>Отсутствует | No heating</option>
              <option value=7>Другое | Other</option>
         </select>
<!--heating//-->
               <hr>
<!--internet-->
               <label class="form-check-label" for="">Интернет | Internet</label>
         <div class="form-check">
              <input name="internet_op_1" class="form-check-input" type="checkbox" id="inetlineCheckbox1" value=1>
              <label class="form-check-label" for="inetlineCheckbox1">Ethernet/ GPON(optic)</label>
            </div>
            <div class="form-check">
              <input name="internet_op_2"  class="form-check-input" type="checkbox" id="inetlineCheckbox2" value=2>
              <label class="form-check-label" for="inetlineCheckbox2">ADSL</label>
        </div>
           <div class="form-check ">
              <input name="internet_op_3"  class="form-check-input" type="checkbox" id="inetlineCheckbox3" value=3>
              <label class="form-check-label" for="inetlineCheckbox3">Отсутствует | No internet</label>
            </div>
<!--internet//-->
               <hr>
<!--MaxLiving-->
               <label for="number_living" class="form-label">Максимум проживающих | Max. lodgers</label>
               <input name="number_living" class="form-control" type="number" min="1" placeholder="Введите число | Input number" id="number_living" aria-label=" input number_living">
<!--MaxLiving//-->
               <hr>
<!--freespace-->
               <label for="freespace" class="form-label">Свободны места для ... человек | free space for ... person</label>
               <input name="freespace" class="form-control" type="number" min="1" placeholder="Введите число | Input number" id="freespace" aria-label=" input freespace">
<!--freespace//-->
               <hr>
<!--MinMaxCoast-->
             <div class="row">
               <label for="min_cost" class="form-label">Минимальная и/или максимальная сумма аренды на человека в USD/месяц | Minimum and/or maximum rental amount per person, USD/month</label>
               <div class="col">
                   <input name="min_cost" class="form-control" type="number" min="0" placeholder="Min $/month" id="min_cost" aria-label="input minprice">
               </div>
               <div class="col">
                   <input name="max_cost" class="form-control" type="number" min="0" placeholder="Max $/month" id="max_cost" aria-label="input max_cost">
               </div>
            </div>
<!--MinMaxCoast//-->
               <hr>
<!--MinMaxRentalPeriod-->
               <label for="min_rental_period" class="form-label">Минимальный срок аренды в месяцах не более | Minimum rental period in months no more </label>
                   <input name="min_rental_period" class="form-control" type="number" min="1" placeholder="Min months" id="min_rental_period" aria-label="input min_rental_period">

<!--MinMaxRentalPeriod//-->
   <hr>
<!--WithAnimals-->
             <label class="form-check-label" for="">С животными | Animals allowed</label>
         <div class="form-check">
              <input name="with_animals" class="form-check-input" type="radio" id="with_animals" value='True'>
              <label class="form-check-label" for="with_animals">да | yes</label>
         </div>
          <div class="form-check">
             <input name="with_animals" class="form-check-input" type="radio" id="with_animals" value='False'>
              <label class="form-check-label" for="with_animals">нет | no</label>
          </div>
<!--WithAnimals//-->
             <hr>
<!--can_smoke-->
          <label class="form-check-label" for="">Можно курить | Smoking allowed</label>
         <div class="form-check">
              <input name="can_smoke" class="form-check-input" type="radio" id="can_smoke" value='True'>
              <label class="form-check-label" for="can_smoke">да | yes</label>
         </div>
          <div class="form-check">
             <input name="can_smoke" class="form-check-input" type="radio" id="can_smoke" value='False'>
              <label class="form-check-label" for="can_smoke">нет | no</label>
          </div>
<!--can_smoke//-->
              <hr>
<!--separate_room-->
         <div class="form-check">
              <input name="separate_room" class="form-check-input" type="radio" id="separate_room" value='True'>
              <label class="form-check-label" for="separate_room">Отдельная комната | Private room</label>
         </div>
<!--separate_room//-->
               <hr>
<!--has_balcony-->
         <div class="form-check">
              <input name="has_balcony" class="form-check-input" type="radio" id="has_balcony" value='True'>
              <label class="form-check-label" for="has_balcony">Есть балкон | Has balcony</label>
         </div>
<!--has_balcony//-->
              <hr>
<!--has_loggia-->
         <div class="form-check">
              <input name="has_loggia" class="form-check-input" type="radio" id="has_loggia" value='True'>
              <label class="form-check-label" for="has_loggia">Есть лоджия | Has loggia</label>
         </div>
<!--has_loggia//-->
              <hr>
<!--has_parking-->
         <div class="form-check">
              <input name="has_parking" class="form-check-input" type="radio" id="has_parking" value='True'>
              <label class="form-check-label" for="has_parking">Есть парковка | Has parking</label>
         </div>
<!--has_parking//-->
              <hr>
<!--transport_nearby-->
         <div class="form-check">
              <input name="transport_nearby" class="form-check-input" type="radio" id="transport_nearby" value='True'>
              <label class="form-check-label" for="transport_nearby">Общественный транспорт рядом | Public transport nearby</label>
         </div>
<!--transport_nearby//-->
              <hr>
      </div><!--col//-->
             <button class="btn btn-success my-1 float-start" type="submit" >Искать | Search</button>
    </div><!--row//-->
</form>
<!--DiscardFilters-->
            <form method="get">
                <div class="row">
                    <button name="discard_filters" type="submit" class="btn btn-outline-secondary" value="True" style="float: right">Сбросить фильтры | Discard filters</button>
                </div>
            </form>
<!--DiscardFilters//-->
            </div>
        </div>
<!-- ========================= FILTERS END// ========================= -->
    <!--============== SELECTED =================-->
    {% if offers_count %}
      <strong><p>Найдено предложений {{ offers_count }} | {{ offers_count }} offers found</p></strong>
     {% else %}
        <p>Ничего не найдено, проверьте выбрана ли страна и город, измените или сбросьте фильтры</p>
        <p>Nothing found, check if country and city are selected, change or reset filters</p>
    {% endif %}
    {% if filters_selected %}
        <p><strong>Выбраны фильтры | filters selected:  </strong>{{ filters_selected }}</p>
    {% endif %}
<!--============== SELECTED //=================-->
<!-- ========================= QUERYSET DISPLAY ========================= -->
       <div class="col">
        {% for offer in page_obj %}
           <hr>
            <div class="card col-9 border-0">
              <div class="row g-0">
                <div class="col-md-3">

                 {% if offer.photo_1.url is not None %}
                   <a href="{{ offer.get_url }}"><img src="{{ offer.photo_1.url }}" class="img-fluid rounded-start" alt="photo"></a>
                {% else %}
                        <a href="{{ offer.get_url }}"><img src='/static/images/Desktop - 1.png' class="img-fluid rounded-start" alt="photo"></a>
                {% endif %}
                </div>
                <div class="col-md-9">
                  <div class="card-body small">
                        <a class="" href="{{ offer.get_url }}"><h5 class="card-title text-dark">{{ offer.name }},  {{ offer.district }}</h5></a>
                        <p class="card-text">
                            <div class="row">
                               <div class="col">
                                   <dl class="row">
                                       <dt class="col-4 text-muted">Помещение | Housing</dt>
                                      <dd class="col-8"><b>{{ offer.get_house_type_display }}</b>; комнаты | rooms: <b>{{ offer.get_number_of_rooms_display }}</b>; площадь | area <b>{{ offer.house_area }} m2</b></dd>
                                      <dt class="col-4 text-muted">Сдается для | For rent for</dt>
                                      <dd class="col-8"><b>{{ offer.get_desired_lodgers_gender_display }}</b></dd>
                                      <dt class="col-4 text-muted">Сейчас живут | Gender of current tenants</dt>
                                      <dd class="col-8"><b>{{ offer.get_sex_of_now_lodgers_display}}</b></dd>
                                       <dt class="col-4 text-muted">Стоимость аренды на человека | Rental amount per person</dt>
                                      <dd class="col-8"><b>{{ offer.cost_per_person }}$</b> per month | в месяц</dd>
                                       <dt class="col-4 text-muted">Свободно мест | Free space for lodgers</dt>
                                       <dd class="col-8"><b>{{ offer.free_space_for_num_person }}</b></dd>
                                   </dl>
                               </div>
                            </div>
                        </p>
                        <p class="card-text"><small class="text-muted">Создано | Created at {{ offer.created_date }}</small></p>
                  </div>
                </div>
              </div>
            </div>
          {% endfor %}

        </div>
   </div><!--start//-->
</div><!--row//-->
<!-- ========================= QUERYSET DISPLAY END// ========================= -->
<!--============== pagination =================-->
<nav aria-label="Page navigation">
{% if page_obj.has_other_pages %}
    <ul class="pagination">
        {% if page_obj.has_previous %}
            <li class="page-item"><a class="page-link mx-1" style="color: #1a1e21" href="?page={{ page_obj.previous_page_number }}">Previous</a></li>
        {% else %}
            <li class="page-item disabled"><a class="page-link mx-1" style="color: #1a1e21" href="#">Previous</a></li>
        {% endif %}
    {% if page_obj.number|add:'-4' > 1 %}
    <li class="page-item"><a class="page-link border-0" style="color: #1a1e21" href="?page={{ page_obj.number|add:'-5' }}">&hellip;</a></li>
    {% endif %}

{% for i in page_obj.paginator.page_range %}
    {% if page_obj.number == i %}
            <li class="page-item disabled">
              <a class="page-link mx-1" style="color: #1a1e21" href="#" tabindex="-1" aria-disabled="true">{{ i }}</a>
            </li>
    {% elif i > page_obj.number|add:'-5' and i < page_obj.number|add:'5' %}
         <li class="page-item"><a class="page-link border-0" style="color: #1a1e21" href="?page={{ i }}">{{ i }}</a></li>
    {% endif %}
{% endfor %}

{% if page_obj.paginator.num_pages > page_obj.number|add:'4' %}
    <li class="page-item"><a class="page-link border-0" style="color: #1a1e21" href="?page={{ page_obj.number|add:'5' }}">&hellip;</a></li>
{% endif %}

    {% if page_obj.has_next %}
        <li class="page-item"><a class="page-link mx-1" style="color: #1a1e21" href="?page={{ page_obj.next_page_number }}">Next</a></li>
    {% else %}
        <li class="page-item disabled"><a class="page-link mx-1" style="color: #1a1e21" href="#">Next</a></li>
    {% endif %}
  </ul>
{% endif %}
</nav>
<!--============== pagination =================-->
</section>
<!-- ========================= SECTION  END// ========================= -->
{% endblock %}

